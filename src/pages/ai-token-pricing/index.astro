---
import { db, Model, Provider, eq } from "astro:db";
import TokenPriceTracker from "../../components/TokenPriceTracker";
import Layout from "../../layouts/main-layout.astro";

const models = await db
    .select({
        id: Model.id,
        name: Model.name,
        slug: Model.slug,
        inputPrice: Model.inputPrice,
        outputPrice: Model.outputPrice,
        contextWindow: Model.contextWindow,
        description: Model.description,
        provider: {
            name: Provider.name,
            slug: Provider.slug,
        },
    })
    .from(Model)
    .innerJoin(Provider, eq(Model.providerId, Provider.id));

const title =
    "Live AI Token Price Tracker 2025 | Compare GPT-4, Claude & Gemini Costs";
const description =
    "Current pricing for 50+ AI models including OpenAI, Anthropic, and Google. Track cost per million tokens, context windows, and price history. Updated daily.";

const schema = {
    "@context": "https://schema.org",
    "@type": "DataCatalog",
    name: "Live AI Token Price Tracker",
    description: description,
    url: "https://usagepricing.com/ai-token-pricing",
    creator: {
        "@type": "Organization",
        name: "UsagePricing",
        url: "https://usagepricing.com",
    },
    dataset: models.map((model) => ({
        "@type": "Dataset",
        name: `${model.name} Pricing`,
        description: `Track the latest API pricing for ${model.name} from ${model.provider.name}. Includes input and output token costs per 1 million tokens, context window specifications, and price history updates.`,
        url: `https://usagepricing.com/ai-token-pricing/${model.provider.slug}/${model.slug}`,
        creator: {
            "@type": "Organization",
            name: "UsagePricing",
        },
        license: "https://creativecommons.org/licenses/by/4.0/",
    })),
};
---

<Layout title={title} description={description}>
    <main class="container mx-auto px-4 py-12 max-w-6xl">
        <div class="text-center mb-12">
            <h1
                class="text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4 tracking-tight"
            >
                AI Token Price Tracker
            </h1>
            <p
                class="text-xl text-gray-600 dark:text-gray-400 max-w-2xl mx-auto"
            >
                The industry's most accurate live tracker for LLM API costs.
                Compare input/output prices per 1M tokens across OpenAI,
                Anthropic, Google, and more.
            </p>
        </div>

        <div class="mb-16">
            <TokenPriceTracker client:load initialData={models} />
        </div>

        <div
            class="prose dark:prose-invert max-w-none text-gray-600 dark:text-gray-300"
        >
            <h2 class="text-gray-900 dark:text-white">
                Why Track AI Token Prices?
            </h2>
            <p>
                As AI models evolve, pricing becomes a moving target. Developers
                and businesses need a reliable source of truth to estimate costs
                and calculate ROI. Our tracker monitors the latest API pricing
                changes so you can make informed decisions.
            </p>

            <div class="grid md:grid-cols-3 gap-8 mt-8 not-prose">
                <div
                    class="bg-gray-50 dark:bg-white/5 p-6 rounded-lg border border-gray-200 dark:border-white/10"
                >
                    <h3
                        class="text-lg font-semibold text-gray-900 dark:text-white mb-2"
                    >
                        Real-time Updates
                    </h3>
                    <p class="text-gray-600 dark:text-gray-400 text-sm">
                        Prices are updated daily to reflect the latest API
                        changes and discounts.
                    </p>
                </div>
                <div
                    class="bg-gray-50 dark:bg-white/5 p-6 rounded-lg border border-gray-200 dark:border-white/10"
                >
                    <h3
                        class="text-lg font-semibold text-gray-900 dark:text-white mb-2"
                    >
                        Apples-to-Apples
                    </h3>
                    <p class="text-gray-600 dark:text-gray-400 text-sm">
                        Standardized "per 1M tokens" pricing makes comparison
                        easy across different providers.
                    </p>
                </div>
                <div
                    class="bg-gray-50 dark:bg-white/5 p-6 rounded-lg border border-gray-200 dark:border-white/10"
                >
                    <h3
                        class="text-lg font-semibold text-gray-900 dark:text-white mb-2"
                    >
                        Historical Trends
                    </h3>
                    <p class="text-gray-600 dark:text-gray-400 text-sm">
                        Track price drops and new model launches to time your
                        migrations perfectly.
                    </p>
                </div>
            </div>
        </div>
    </main>

    <script type="application/ld+json" set:html={JSON.stringify(schema)} />
</Layout>
