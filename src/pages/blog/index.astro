---
import BlogHeader from "@/components/blog-header.astro";
import BlogCard from "@/components/cards/blog-card.astro";
import MainLayout from "@/layouts/main-layout.astro";
import { getPosts } from "@/lib/fetchers";
import { getPublishedPosts } from "@/lib/content.js";

const posts = await getPublishedPosts();
//const posts = await getPosts();

const title = "Blog - SaaS Pricing & AI Monetization Strategies";
const description =
  "Explore expert insights on usage-based pricing models, AI token monetization, and FinOps strategies for modern SaaS companies.";

const structuredData = {
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "CollectionPage",
      "@id": "https://usagepricing.com/blog/#webpage",
      url: "https://usagepricing.com/blog",
      name: title,
      description: description,
      isPartOf: { "@id": "https://usagepricing.com/#website" },
      breadcrumb: { "@id": "https://usagepricing.com/blog/#breadcrumb" },
      mainEntity: {
        "@type": "ItemList",
        itemListElement: posts.map((post, index) => ({
          "@type": "ListItem",
          position: index + 1,
          url: `https://usagepricing.com/blog/${post.slug}`,
        })),
      },
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://usagepricing.com/blog/#breadcrumb",
      itemListElement: [
        {
          "@type": "ListItem",
          position: 1,
          name: "Home",
          item: "https://usagepricing.com",
        },
        {
          "@type": "ListItem",
          position: 2,
          name: "Blog",
          item: "https://usagepricing.com/blog",
        },
      ],
    },
  ],
};
---

<MainLayout title={title} description={description}>
  <script
    type="application/ld+json"
    set:html={JSON.stringify(structuredData)}
  />
  <section class="container py-10">
    <nav aria-label="Breadcrumb" class="mb-6">
      <ol class="flex items-center text-sm text-muted-foreground">
        <li>
          <a href="/" class="hover:text-foreground transition-colors">Home</a>
        </li>
        <li class="mx-2 text-muted-foreground/50">/</li>
        <li class="font-medium text-foreground">Blog</li>
      </ol>
    </nav>

    <BlogHeader title="Blog" />

    <div
      class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-9 md:gap-y-11 lg:gap-y-16 lg:gap-x-8"
    >
      {
        posts.map((post, index) => (
          <BlogCard {...post} loading={index < 6 ? "eager" : "lazy"} />
        ))
      }
    </div>
  </section>
</MainLayout>
